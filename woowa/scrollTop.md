# 모바일과 PC 웹브라우저의 scrollTop

- 모바일 웹을 작업하고 있는데 스크롤을 구현하는게 상당히 골치가 아픕니다. 스크롤은 어디나 들어가는 아주 일반적인 기능이라고 생각하고 있었음에도 구현하는데 여러가지 어려움이 상당히 많습니다.

## 스크롤

- 스크롤 영역으로 지정하는 것은 딱히 모바일 웹에 특화된 것은 아닙니다.
- 스크롤을 사용할 곳의 크기를 지정하고 CSS 속성에서 overflow: auto;로 지정하면 됩니다.
- 모바일에서는 이벤트가 다르므로 데스크탑에서는 제대로 동작하지 않을 수 있으므로 모바일장비에서 테스트해봐야 합니다.
- 모바일에서는 마우스가 없으므로 터치이벤트를 통해서 스크롤이 동작하게 되는데 터치할 때 touchstart 이벤트가 발생하고 움직이면 touchmove가 발생하고 손가락을 뗄 때 touch가 발생합니다. 움직이지 않고 바로 떼면 touchmove가 발생하지 않고 바로 touchend가 발생합니다. 여기서는 스크롤 영역에 대한 테스트이므로 touchmove를 통해서 스크롤이 될 때 scroll이벤트도 함께 발생합니다.
- 좌표와 관련해서는 스크롤 영역에는 scrollTop이라는 속성이 존재합니다. 가장 최상위에 있을 때는 scrollTop이 0이고 스크롤을 내릴 수록 값이 커지게 됩니다.

## 모멘텀(momentum) 스크롤

- 모바일에서 스크롤을 할 경우에는 가속도가 먹어서 손가락을 튕기면 스크롤이 빠르게 이동하는 스크롤을 사용하고 사용자에게도 이게 당연한 동작입니다. 이를 모멘텀 스크롤이라고 부르는데 앞에서 본 예제는 손가락을 떼는 순간 스크롤이 멈추기 때문에 사용하기가 아주 불편합니다.
- iOS 즉 모바일 사파리(웹뷰 포함)에서 모멘텀 스크롤을 사용하려면 스크롤 영역에 -webkit-overflow-scrolling: touch; CSS 속성을 지정한다. 이 스타일만 지정하면 스크롤이 자연스러운 모멘텀 스크롤로 동작하게 됩니다.
- 모멘텀 스크롤 중에는 scrollTop이 업데이트되지 않습니다. 모멘텀 스크롤을 손가락으로 스크롤 영역을 튕겨서 동작하므로 즉 touchend이벤트가 발생한 이후에도 스크롤이 계속 이동하게 되는데 tocuchend이벤트까지는 scrollTop이 갱신되지지만 touchend이벤트가 발생한 이후에 모멘텀 스크롤가 동작하는 동안에는 scrollTop이 변하지 않고 모멘텀 스크롤이 시간이 지나서 자동으로 멈춘 순간 scroll이벤트가 발생하면서 scrollTop이 갱신됩니다. 그래서 현재 스크롤이 어느 위치에 있는지 찾을 수가 없고 심지어 모멘텀 스크롤이 동작하고 있다는 것 조차 알 수가 없습니다.(나중에 scroll이벤트가 발생하므로 모멘텀 스크롤이 동작했었구나 정도만 알 수 있습니다.)

## 모멘텀 스크롤에서 선택영역 사용하기

- 모멘텀 스크롤에서 선택영역을 함께 사용하지 않는다면 큰 문제는 없습니다.
- scrollTop이 업데이트되지 않으므로 모멘텀 스크롤중의 터치도 잘못된 좌표가 인식됩니다. 

## scrollTop 사용 방법
- var a = $("html").scrollTop() || $("body").scrollTop();

---

[모바일 사파리에서 스크롤 구현과 관련된 문제](https://blog.outsider.ne.kr/971)