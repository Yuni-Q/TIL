# 싱글턴 패턴
- 인스턴스가 하나 뿐인 특별한 객체를 만들 수 있게 해 주는 패턴이죠. 싱글턴 패턴은 클래스 다이어그램만 놓고 보면 그 어떤 패턴보다도 간단합니다. 클래스 다이어그램에 클래스가 달랑 하나 밖에 없으니까요. 하지만 그렇다고 해서 너무 만만하게 보지는 마세요. 클래스 디자인 관점에서 보면 아주 단순하지만 구현하는 데 있어서는 적지 않은 난관이 기다리고 있을 테니까요.

## 유일무이한 객체
- 객체 중에서는 사실 하나만 있으면 되는 것이 많습니다. 스레드 풀이라든가, 캐시, 대화상자, 사용자 설정이라든가 레지스트리 설정을 처리하느 객체, 로그 기록용 객체, 프린터나 그래픽 카드 같은 디바이스를 위한 드라이버 같은 걸 예로 들 수 있다. 사실 이런 형식의 객체를 쓸 때는 인스턴스를 두 개 이상 만들게 되면 프로그램이 이상하게 돌아간다든가 자원을 불필요하게 잡아먹는다든가 결과에 일관성이 없어지는 것같 은 심각한 문제가 생길 수 있습니다.
- 싱글턴 패턴(Singleton Pattern)은 특정 클래스에 대해서 객체 인스턴스가 하나만 만들어질 수 있도록 해 주는 패턴입니다. 싱글턴 패턴을 사용하면 전역 변수를 사용할 때와 마찬가지로 객체 인스턴스를 어디서든 액세스 할수 있도록 할 수 있습니다. 게다가 전역 변수를 쓸 때처럼 여러 단점을 감수해야하는 것도 아닙니다.
  - 전역 변수의 단점
    - 전역 변수에 객체를 대입하면 애플리케이션이 시작될 때 객체가 생성될 것입니다. 그런데 그 객체가 자원을 많이 차지한다고 해 봅시다. 만약 애플리케이션이 끝날 때까지 그 객체를 한 번도 쓰지 않는다면 괜히 자원만 잡아먹는, 아무 데도 쓸 데 없는 객체가 되고 맙니다. 실글턴 패턴을 쓰면 필요할 때만 객체를 만들 수가 있습니다.
    - 사실 플랫폼에 따라 달라질 수 있습니다. 어떤 JVM에서는 나중에 필요할 때 생성하기도 합니다.
- 정적 클래스 변수와 메소드를 잘 처리할 수 있고 접근 변경자(access modifier)도 잘 다룰 줄 안다면 별로 어렵지 않겟지만 싱글턴 패턴이 어떤 식으로 작동하는지 배워 두는 건 도움이 될 것입니다.

```java
public class Singleton  {
  private static Singleton uniqueInstance;

  // 기타 인스턴스 변수

  private Singleton() {}

  public static Singleton getInstance() {
    if (uniqueInstance == null) {
      // uniqueInstance에 하나 밖에 없는 인스턴스 변수가 저장 됩니다. 정적 변수라는 걸 잊지 마세요.
      // uniqueInstance가 null이면 아직 인스턴스가 생상되지 않았다는 것을 알 수 있습니다.
      uniqueInstance = new Singleton();
      // 아직 인스턴스가 만들어지지 않았다면 private으로 선언된 생성자를 이용해서 Single 객체를 만든 다음 uniqueInstance에 그 객체를 대입합니다.
      // 이렇게 하면 인스턴스가 필요한 상황이 닥치기 전에는 아예 인스턴스를 생성하지 않게 되죠.
      // 이런 방법을 '게으른 인스턴스 생성(lazy instantiation)'이라고 부릅니다.
    }
    return uniqueInstance;
  }

  // 기타 메소드
}
```

## 싱글턴 패턴의 정의
- 싱글턴 패턴 : 싱글턴 패턴은 해당 클래스의 인스턴스가 하나만 만들어지고, 어디서든지 그 인스턴스에 접근할 수 있도록 하기 위한 패턴입니다.
- 클래스에서 자신의 단 하나뿐인 인스턴스를 관리하도록 만들면 됩니다. 그리고 다른 어떤 클래스에서도 자신의 인스턴스를 추가로 만들지 못하도록 해야 합니다. 인스턴스가 필요하면 반드시 클래스 자신을 거치도록 해야 합니다.
- 그리고 어디서든 그 인스턴스에 접근할 수 있도록 만들어야 합니다. 다른 객체에서 이 인스턴스가 필요하면 언제든지 클래스한테 요청을 할 수 있게 만들고, 요청이 들어오면 그 하나뿐인 인스턴스를 건네주도록 만들어야 합니다.

## 멀티스레딩 문제 해결 방법
- getInstance()를 동기화시키기만 하면 멀티스레딩과 관련된 문제가 간단하게 해결됩니다.
- 하지만 동기화를 하기가 정말 아깝다는 느낌이 들 수도 있습니다. 사실 동기화가 꼭 필요한 시점은 이 메소드가 시작되는 때 뿐입니다. 첫 번째 과정을 제외하면 동기화는 불필요한 오버헤드만 증가시킬 뿐입니다.

### 더 효율적인 방법
- getInstance()의 속도가 그리 중요하지 않다면 그냥 둡니다.
- 인스턴스를 필요할 때 생성하지 말고, 처음부터 만들어 버립니다.
- DCL(Double-Checking Locking)을 써서 getInstance()에서 동기화 되는 부분을 줄입니다.

## 디자인 도구 상자 안에 들어가야 할 도구들
- 싱글턴 패턴은 객체를 생성하는 또 다른 방법을 제공합니다. '유일한' 객체를 생성하는 방법을 제공하죠.

### 객체지향 패턴
- 싱글턴 패턴 : 클래스 인스턴스가 하나만 만들어지도록 하고, 그 인스턴스에 대한 전역 접근을 제공합니다.

### 핵심정리
- 어떤 클래스에 싱글천 패턴을 적용하면 애플리케이션에 그 클래스의 애플리케이션에 그 클래스 인스턴스가 최대 한 개까지만 있도록 할 수 있습니다.
- 싱글턴 패턴을 이용하면 유일한 인스턴스를 어디서든지 접근할 수 있도록 할 수 있습니다.
- 자바에서 싱글턴 패턴을 구현 할 때는 private 생성자와 정적 메소드, 정적 변수를 사용합니다.
- 다중 스레드를 사용하는 애플리케이션에서는 속도와 자원 문제를 파악해보고 적절한 구현법을 사용해야 합니다(사실 모든 애플리케이션에서 멀티스레딩을 쓸 수 있다고 생각해야 합니다)
- DCL을 사용하는 방법은 자바2 버전5(자바 1.5)보다 전에 나온 버전에서는 쓸 수 없는 점에 주의하세요.
- 클래스 로더가 여러 개 있으면 싱글턴이 제대로 작동하지 않고, 여러 개의 인스턴스가 생길 수 있습니다.
- 1.2 버전보다 전에 나온 JVM을 사용하는 경우에는 가비지 컬렉터 관련 버그 때문에 싱글턴 레지스트리를 사용해야 할 수도 있습니다.