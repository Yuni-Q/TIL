
# 자동화

1. 리소스 배분
하나의 서비스가 사용하는 리소스의 양은 일반적으로 운용하는 서버 한 대의 가용 리소스 대비 매우 적다. 그렇다고 하나의 서버에 이런저런 서비스를 있는대로 올리면 어느 순간 서버가 갑자기 죽어 나가면서 장애의 순간을 맞게 된다. 때문에 서버가 죽지 않도록 서비스들을 각 서버에 배치하는 것은 매우 조심스럽고 어려운 일이다.  

1. Metric & Log 수집  
내가 개발한 서비스가 정확하게 동작하고 있는지, 얼마만큼의 리소스를 요구하고 있는지, 어떤 부분에서 무슨 이유로 장애가 발생했는지 알기 위해서는 로그와 메트릭 수집이 중요하다. 일반적으로 Agent들을 설치해서 수집한다. 다만, 시스템 정보를 통해 확인할 수 있는 메트릭에 비해 각 서비스별로 수집해야 하는 로그는 보통 파일로 쓰고 Agent가 그 파일의 변경을 추적해서 중앙에 집중시키는데, 로그파일이 디스크를 꽉 채워서 서버를 통째로 죽이는 일도 빈번하고, 서버에 새로운 서비스를 배치할 때마다 로그 수집 환경을 추가해야 하는 것도 번거롭다.  

1. 무정지 배포  
REST API를 중심으로 서비스하는 환경에서는 새로운 버전을 배포할 때 기존의 배포된 버전이 새로운 버전으로 교체되기 전에 기존의 사용자 요청에 대해 안전하게 응답을 마치고 종료되기를 희망한다. 그러나 여러가지 시나리오 때문에 쉽게 가능한 일은 아니다.  

1. 서비스 변화와 확장에 따른 Routing 설정 변경  
가장 짜증날 수 있는 부분이다. 앞서 이야기한 적절한 리소스의 배분과 무정지 배포를 신경 쓰면서 추가와 삭제, 스케일링 되는 서비스들을 유기적으로 로드밸런서에 연결하기란 쉽지 않다. 게다가 마이크로 아키텍처에서 REST API 서비스를 위해서는 Host Domain과 URI Path에 따라 다양하고 복잡한 라우팅 변경이 빈번하게 요구된다.  

---
참조 : [토스의 백엔드는 어떻게 자동화되는가?
](https://medium.com/@ghilbut/%ED%86%A0%EC%8A%A4%EC%9D%98-%EB%B0%B1%EC%97%94%EB%93%9C%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EC%9E%90%EB%8F%99%ED%99%94%EB%90%98%EB%8A%94%EA%B0%80-6042e6bd110d?fbclid=IwAR18UmsRQaMSx7dUm5oe1mQsoOlrebRif_7NgpV0dkj_dPqnBaB9Qvf2R1I)