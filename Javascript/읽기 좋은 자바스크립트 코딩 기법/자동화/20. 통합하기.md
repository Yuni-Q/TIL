# 20. 통합하기

## 다루지 않았던 것들

- 빌드 시스템을 합치기 전에 필요한 작업 중 아직 다루지 않은 두 가지 단계가 있습니다.
  - 첫 번째는 빌드 디렉터리 생성입니다. 빌드 디렉터리는 형상 관리 서버에 저장하지 않는 임시적인 빌드 시스템이 이 디렉터리를 새로 만들어야 합니다.
  - 두 번째는 빌드 디렉터리를 깔끔하게 지우는 작업을 해야 하빈다. 빌드와 빌드 사이에 모든 파일을 깔끔하게 지우고 처음부터 시작하는 게 좋습니다.

## 빌드 계획하기

- 보통 프로젝트의 빌드 타입이 하나인 경우는 드물고 최소 다음 세 개, 또는 그 이사응로 나뉩니다.

### 개발 빌드

- 개발 빌드는 개발자가 개발을 진행하며 수행하는 빌드 입니다. 따라서 개발자의 생산성이 떨어지지 않도록 가능한 빠르게 빌드가 완료 되어야 합니다.
- 개발 빌드의 목적은 실수에 의한 에러를 방지하고 코드가 브라우저에서 정상적으로 동작하는지 확인하기 좋게 코드를 만드는 것입니다.
- 이 타입의 빌드는 개발 과정에서 수시로 실행하는 빌드라서 15초 이상 걸리면 안되므로 처리할 작업을 신중히 선택해야 합니다.
- 만약 웹 애플리케이션을 개발 중이라면 전체 웹 애플리케이션 빌드와는 별개로 자바스크립트 빌드만 독립적으로 실행시키도록 할 수도 있습니다.
- 보통 이 개발 빌드를 기본 빌드로 지정합니다.
- 개발 빌드는 모든 개발자의 작업에 영향을 끼치는 빌드 타입이라 정확하게 동작하는 것이 중요합니다.
- 일반적으로 개발 빌드의 목적은 개발 환경에서 사용할 코드를 생성하는 것입니다.
- 가능한 빨리 생성되어야 합니다.
- 보통 개발자 빌드에서 처리하는 작업은 코드 유효성 검사와 파일 합치기 이렇게 두 가지 입니다.
- 개발자가 디버깅을 하려면 전체 소스 코드가 필요하기 때문에 이 단계에서는 코드를 최소화 하지 않습니다.

### 통합 빌드

- 자동 빌드는 보통 정기적인 스케쥴에 따라 실행되는데 경우에 따라 커밋할 때마다 수행되게 하기도 하고 큰 프로젝트에서는 몇 분 단위로 수행되게 하기도 합니다.
- 통합 빌드에서는 전체 애플리케이션의 문제를 찾기 위해 자동으로 빌드를 수행하게 설정해 놓습니다.
- 자동으로 실행되는 테스트라 완료하는 데 시간이 오래 걸려도 상관없지만 빌드 과정이 최대한 철저하게 수행되어야 합니다.
- 떄에 따라서는 통합 빌드가 서버에 반영되기 전 마지막으로 점검하는 최후의 방어선인 경우도 있습니다.
- 통합 빌드는 CI(Continuous Integration) 시스템에서 자동으로 수행되는데 이 단계에서는 에러를 찾는 것이 주된 역할입니다. 따라서 가능한 많이 유효송 검사를 하고 테스트를 수행해야 합니다. 적어도, 개발 빌드에서 수행한 모든 절차는 거쳐야 하며 여기에 추가적으로 단위 테스팅도 수행해야 합니다.
- 코드에 어던 변화가 있었는지 쉽게 알 수 있도록 통합 빌드에서 문서를 자동으로 생성하도록 하는 것도 좋습니다.
- 어떠한 경우든지 통합 빌드가 깨지면 재빠르게 대응해서 다른 개발자의 작업에 영향이 없도록 해야 합니다.

### 릴리즈 빌드

- 필요할 때만 수행되는 빌드로 실제 서버에 배포되기 전에 수행되빈다.
- 이 빌드의 역할은 배포에 최적화된 코드를 생성하는 것입니다.
- 이론적으로는 통합 빌드가 제대로 동작했다면 릴리즈 빌드에서는 에러가 없어야 하지만 실제로 항상 그렇지는 않습니다.
- 릴리즈 빌드는 배포 전에 몇 가지 작업을 더 수행해야 하기 때문에 그 과정에서 에러가 발생할 수 있습니다.
- 릴리즈 빌드는 개발 프로세스의 마지막 단계로 코드가 실제 서버에 배포하기에 적합하다는 판정을 내리기 위해 수행하는 빌드 입니다.
- 이 빌드 단계에서 코드가 생성되면 배포 준비가 거의 다 된 상태이지만 그 전에 유효성 검사와 자동 테스트는 물론이고 직접 테스트 해서 코드에 문제가 없음을 확인해야 합니다.
- 경우에 따라 릴리즈 빌드 에서 파일을 굽거나 저작권 정보, 버전 정보, 그 외의 관련된ㅁ ㅔ타 정보를 넣는 작업만 하기도 합니다.

## CI 시스템 사용하기

- CI 시스템은 특정 액션 이 발생하면 빌드를 자동으로 수행하거나 정기적으로 정해진 시간에 빌드를 수행합니다.
- 또한 빌드가 실패하면 개발자에게 문제를 수정하는 메일을 보내게 설정할 수도 있습니다.

### 젠킨스

- 젠킨스는 가장 많이 쓰는 CI 시스템 입니다.
- 자바 기반 웹 애플리케이션이며 다중 빌드를 관리 할 수 있게 디자인되었습니다.
- 따로 설정하지 않아도 여러 개의 형상 관리 저장소를 사용할 수 있고 폭넓은 플러그인 라이브러리를 통해 많은 기능을 지원합니다.
- 또한 젠킨스는 앤트와 쉘 스크립트로 동작하여 기존 빌드 스크립트를 젠킨스에서 그대로 재상용할 수 있습니다.
- 젠킨스 설정은 상당히 쉬운데 최신 WAR 파일을 내려받고 구동시키면 됩니다.

### 그 외 CI 시스템

- Continuum : 앤트와 메이븐으로 동작하도록 설계된 CI로, 아파치 프로젝트입니다.
- BuildBot : 파이썬 기반 빌드 시스템으로, 엔지니어를 대상으로 만들어 졌습니다.
- Cruise Control : 웹 애플리케이션으로 동작하는 자바 기반 빌드 시스템입니다. 루비와 닷넷으로 포팅된 버전도 있습니다.
- Gradle : 앤드와 메이븐에 그루비 기안 언어를 사용하는 CI로, 프로그래머가 아닌 사람이 다루기에는 조금 어렵습니다.
