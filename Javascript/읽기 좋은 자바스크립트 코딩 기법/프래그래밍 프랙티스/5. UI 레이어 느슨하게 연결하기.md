# 5. UI 레이어 느슨하게 연결하기

- HTML은 페이지에서 데이터와 의미를 정의하는 데 사용합니다.
- CSS는 페이지의 스타일을 꾸미는 데 사용합니다.
- 자바스크립트는 페이지에 동작을 부여하는 데 사용합니다.

## 느슨한 연결이란?

- 컴포넌트를 느슨하게 연결한다는 말은 한 컴포넌트를 수정해도 다른 컴포넌트에 영향이 없는 것을 의미 합니다.
- 여러 개발자가 큰 시스템의 개발과 유지보수를 둘 다 해야하는 상황이라면 컴포넌트 간 느슨한 연결은 필수 입니다. 또 코드를 수정할 때 다른 개발자가 담당하는 부분까지 영향을 끼치지 않길 바란다면 컴포넌트 간 연결은 느슨하게 해야 합니다.
- 컴포넌트가 조금 알수록 전체 시스템은 나이지게 됩니다.
- 컴포넌트를 변경할 때마다 다른 컴포넌트까지변경해야 하는 일이 발생해서는 안됩니다.
- UI 레이어 간에 연결이 느슨하면 일단 버그 찾기가 좋아집니다.

## CSS에서 자바스크립트 분리하기

- IE8 이하 버전에서는 CSS에 자바스크립트를 넣을 수 있었습니다. CSS 표현식을 사용하면 오래된 브라우저를 쉽게 지원할 수 있어 매력적이겠지만, 결과적으로 본다면 이 유혹을 뿌리쳐야 시간을 절약하고 수고를 덜 수 있습니다.

## 자바스크립트에서 CSS 분리하기

- element.style.color과 같은 방식으로 바꾸거나 element.style.cssText와 같은 방법으로 자바스크립트로 CSS를 컨트롤 할 수 있다. 이 방법들은 스타일 정보가 자바스크립에 있어 유지보수에 좋지 않다.
- 요소의 스타일을 변경할 때는 자바스크립트에서 CSS 클래스를 변경한느 방법으로 가야 합니다.
- 자바스크립트와 CSS는 CSS 클래스명을 이용해 통신한다고 생각하면 됩니다.
- 자바스크립트에서 스타일 프로퍼티를 직접 사용하지 말라고 했지만 한 가지 예외사항은 HTML 요소의 위치를 다른 HTML 요소를 기준으로 이동하거나 페이지 사이즈를 조절 할 때는 스타일 프로퍼티를 직접 사용해도 됩니다. 나중에 자바스크립트로 덮어쓸 거라도 CSS 클래스를 정의할 때 기본값은 설정해 두어야 합니다.

## HTML에서 자바스크립트 분리하기

- HTML의 on 속성에 이벤트 핸들러를 추가하면 안 됩니다. 자바스크립트 메서드에서 추가해야 합니다.
- IE8 이하 버전에서는 addEventListener()를 지원하지 않으므로 이벤트 핸드러를 추가할 땐 다음 함수가 필요합니다.

```javascript
function addListener(target, type, handler) {
  if (target.addEventListener) {
    target.addEventListener(type, handler, false);
  } else if (target.attachEvent) {
    target.attachEvent("on", type, handler);
  } else {
    target["on" + type] = handler;
  }
}
```

- 인라인 자바스크립트 코드 역시 HTML 밖으로 빼야 합니다. 그 이유 중 하나는 디버깅이 편해지기 때문입니다.

## 자바스크립트에서 HTML 분리하기

- 개발을 하다 보면 자주 innerHTML 프로퍼티를 이용해 HTML을 추가하기도 합니다.
- 자바스크립트에서 HTML 문자열을 사용하지 말아야 합니다.
  - HTML 텍스트나 구조에 문제가 있을 때 원인을 찾기 어려워집니다.
  - 유지보수와 관련하여도 관리 포인트가 늘어나고 문제점을 찾기 어렵습니다.

### 서버에서 가져오기

- 템플릿을 다른 곳에 두고 XMLHttpRequest를 이용해 마크업을 가져오는 것입니다. 이 방법은 여러 페이지로 구성된 애플리케이션보다는 단일 페이지 애플리케이션에서 사용하면 좋습니다.
- 성능을 생각해서라도 당장 사용하지 않을 큰 용량의 마크업은 메모리나 DOM에 추가해서는 안 됩니다. 물론 크기가 작은 마크업이라면 클라이언트 사이드 템플릿을 이용해도 좋습니다/

### 간단한 클라이언트 사이드 템플릿

- 템플릿을 HTML 주석으로 추가하는 방법
  - 브라우저는 주석도 다른 요소나 텍스트와 마찬가지로 DOM 노드로 인식합니다. 즉, 스크립트에서 템플릿 조회할 수도 있고 가져올 수도 있습니다.
- script 요소를 이용해 사용자 타입 프로퍼티를 만드는 것입니다. 브라우저는 script 요소에 속성을 따로 입력하지 않으면 자바스크립트로 인식하지만 type 속성에 자바스크립트가 아니라고 명시하면 자바스크립트로 해석하지 않습니다.
  - 템플릿을 추가할 때는 script 태그를 열고 다음 줄에 템플릿을 입력하기 때문에 필요 없는 공백이 들어갈 수밖에 없습니다. 공백을 제거하지 않은 템플릿을 div 요소에 추가한다면 브라우저가 템플릿을 li 요소로 인식하지 않고 텍스트 노드로 인식할 수도 있습니다.

### 복잡한 클라이언트 사이드 템플릿

- handlebars 사용
