
# 프로젝트에서 1인분 하기

## 서버 구축

### Web Server? Web Application Server??

1. 웹 서버 : 웹 브라우저와 같은 클라이언트로부터 HTTP 요청을 받아들이고, HTML 문서와 같은 웹 페이지를 반환하는 컴퓨터 프로그램입니다.
1. 웹 애플리케이션 서버(Web Application Server, 약자 WAS)는 웹 애플리케이션과 서버 환경을 만들어 동작시키는 기능을 제공하는 소프트웨어 프레임워크입니다. 인터넷 상에서 HTTP를 통해 사용자 컴퓨터나 장치에 애플리케이션을 수행해 주는 미들웨어(소프트웨어 엔진)으로 볼 수 있습니다. 웹 애플리케이션 서버는 <b>동적 서버 콘텐츠를 수행하는 것으로 일반적인 웹 서버와 구별이 되며</b>, 주로 데이터베이스 서버와 같이 수행이 됩니다. 한국에서는 일반적으로 "WAS" 또는 "WAS S/W"로 통칭하고 있으며 공공기관에서는 "웹 응용 서버"로 사용되고, 영어권에서는 "Application Server" (약자 AS)로 불립니다.

1. WEB 서버는 HTML 문서같은 정적 컨텐츠를 처리하는 것이고 (HTTP 프로토콜을 통해 읽힐 수 있는 문서)
WAS 서버는 asp, php, jsp 등 개발 언어를 읽고 처리하여 동적 컨텐츠, 웹 응용 프로그램 서비스를 처리하는 것입니다.

> 쉽게 동적 컨텐츠와 정적 컨텐츠로 구분 할 수 있습니다.<br>
> 성능 때문에 WAS 앞에 Web Server를 두기도 했지만 톰캣 5.5가 되면서 Httpd의 native모듈을 사용해서 스태틱파일을 처리하는 기능을 제공해 성능 차이가 없어졌습니다.따라서 단지 스태틱 파일 처리의 성능만을 위해서라면 굳이 톰캣 앞에 Apache Httpd를 두는 것은 불필요 하다. 오히려 메모리만 많이 먹고 관리부담은 커지고, 불필요한 부하만 걸릴 뿐입니다. 하지만 하나의 서버에서 PHP애플리케이션과 자바 애플리케이션을 함께 사용하거나, Httpd 서버를 간단한 로드밸런싱을 위해서 사용해야 하는 경우라면 Httpd를 앞에 두고 톰캣을 연결해서 사용 합니다.

### 프록시 서버
프록시 서버(영어: proxy server 프록시 서버)는 클라이언트가 자신을 통해서 다른 네트워크 서비스에 간접적으로 접속할 수 있게 해 주는 컴퓨터나 응용 프로그램을 가리킵니다. 서버와 클라이언트 사이에서 중계기로서 대리로 통신을 수행하는 기능을 가리켜 '프록시', 그 중계 기능을 하는 것을 프록시 서버라고 부릅니다. 서버에 요청된 내용들을 캐시를 이용하여 저장합니다.

1. 보안 : 익명의 사용자가 서버에 접근하는 것을 막습니다.
1. 속도 : Proxy 서버는 사용자의 요청을 Cache해서 동일한 요청이 들어오면 Cache 자원을 반환합니다.
1. ACL : 사이트 접근에 대한 정책을 정희 할 수 있습니다.
1. Log/Audit : 회사 내 직원의 인터넷 사용을 레포팅 할 수 있습니다. 반대로 인트라넷의 사용을 레포팅 할 수도 있습니다.
1. 지역 네트워크의 제한 우회 : 보안상의 이유로 80포트 외에 포트를 막아 놓는 경우가 있는데 이러한 제한을 우회해서 원하는 다른 서비스를 이용 할 수 있습니다.

#### 종류
1. Caching Proxy Server : 이전 클라이언트의 요청 내용과 응답 컨텐츠를 저장해 두었다가 동일한 요청이 들어오면 저장된 컨텐츠를 전송 합니다.
1. Web Proxy : World Wide Web 트래픽에 초점이 맞춰진 Proxy 서버 입니다.
1. Foward Proxy : 일반적으로 사용하는 Proxy 방식입니다.
1. Reverse Proxy : 애플리케이션 서버는 외부로 부터 감추어지는 효과를 얻게 됩니다.

##### 역방향 프록시?
역방향 프록시는 프록시 서버의 특정한 대체 사용 이름입니다. 방화벽 외부에서 외부 클라이언트에게 보안 컨텐트 서버를 표시하는 데 사용할 수 있습니다. 이를 통해 기업 외부로부터 서버의 데이터에 대한 직접적이고 모니터되지 않는 액세스를 방지합니다. 또한 복제용으로 사용할 수도 있습니다. 즉 로드 밸런싱을 위해 사용량이 많은 서버의 전면에 여러 프록시를 연결할 수 있습니다.

### Load Balancer
하나의 인터넷 서비스가 발생하는 트래픽이 많을 때 여러 대의 서버가 분산처리하여 서버의 로드율 증가, 부하량, 속도저하 등을 고려하여 적절히 분산처리하여 해결해주는 서비스입니다.

#### 필요한 이유
Server는 모든 사람들의 응답을 해주려고 노력하지만 결국엔 지치게 되어 동작을 멈추게 됩니다.

#### 해결 방안
Scale-up : Server가 더 빠르게 동작하기 위해 하드웨어 성능을 올리는 방법.<br>
Scale-out : 하나의 Server 보다는 여러 대의 Server가 나눠서 일을 하는 방법.<br>
> Scale-out의 장점은 무엇이 있을까요?<br>
> 하드웨어 향상하는 비용보다 서버 한대 추가 비용이 더 적습니다.<br>
> 여러 대의 Server 덕분에 무중단 서비스를 제공할 수 있습니다.<br>
> 여러 대의 Server에게 균등하게 Traffic을 분산시켜주는 역할을 하는 것이 Load Balancer입니다.<br>

#### 주요 기능
1. NAT(Network Address Translation)
사설 IP 주소를 공인 IP 주소로 바꾸는 데 사용하는 통신망의 주소 변조기입니다.
1. DSR(Dynamic Source Routing protocol)
로드 밸런서 사용 시 서버에서 클라이언트로 되돌아가는 경우 목적지 주소를 스위치의 IP 주소가 아닌 클라이언트의 IP 주소로 전달해서 네트워크 스위치를 거치지 않고 바로 클라이언트를 찾아가는 개념입니다.
1. Tunneling
인터넷상에서 눈에 보이지 않는 통로를 만들어 통신할 수 있게 하는 개념
데이터를 캡슐화해서 연결된 상호 간에만 캡슐화된 패킷을 구별해 캡슐화를 해제할 수 있습니다.

#### 종류
1. L2 :Mac주소를 바탕으로 Load Balancing합니다.
1. L3 : IP주소를 바탕으로 Load Balancing합니다.
1. L4 Transport Layer(IP와 Port) Level에서 Load Balancing을 합니다. ( TCP, UDP )
1. L7 : Application Layer(사용자의 Request) Level에서 Load Balancing을 합니다. ( HTTP, HTTPS, FTP )

#### Server 선택
1. Round Robin : 단순히 Round Robin으로 분산하는 방식입니다.
1. Least Connections 연결 개수가 가장 서버를 선택하는 방식입니다. 트래픽으로 인해 세션이 길어지는 경우 권장하는 방식입니다.
1. Source : 사용자의 IP를 Hashing하여 분배하는 방식입니다. 사용자는 항상 같은 서버로 연결되는 것을 보장합니다.

### 웹서버

#### Apache(멀티)
아파치 HTTP 서버(영어: Apache HTTP Server)는 아파치 소프트웨어 재단에서 관리하는 HTTP 웹 서버입니다.<br>
BSD, 리눅스 등 유닉스 계열 뿐 아니라 마이크로소프트 윈도우나 노벨 넷웨어 같은 기종에서도 운용할 수 있습니다.<br>

#### Nginx(싱글)
Nginx(엔진 x라 읽는다)는 웹 서버 소프트웨어로, 가벼움과 높은 성능을 목표로 합니다.<br>
웹 서버, 리버스 프록시 및 메일 프록시 기능을 가집니다.<br>

##### 특징
> Module로 구성<br>
> Event-driven 이면서 비동기 방식(Asynchronous)으로 동작<br>
> Single-threaded(worker 프로세스)<br>
> Non-blocking<br>

> 2017년 10월 기준으로 실질적으로 작동하는 웹 사이트(active site)들에서 쓰이는 웹 서버 소프트웨어 순위는 아파치(44.89%), 엔진엑스(20.65%), 구글 웹 서버(7.86%), 마이크로소프트 IIS(7.32%)순이다. 이 조사에서 생성은 되어있으나 정상적으로 작동하지 않는 웹 사이트들은 배제되었으며 특히 MS의 인터넷 정보 서비스(IIS)를 설치한 웹 사이트들의 상당수가 비활성 사이트였다. 그런 사이트들도 포함하면 MS IIS가 1위이다. 2017년 6월 현재 Nginx는 한국 전체 등록 도메인 중 24.73%가 사용하고 있습니다.

### 웹 애플리케이션 

#### 스크립트 언어
Django : Python 기반의 웹 애플리케이션 ( flask도 유명하다 )
Express: JavaScript(Node.js) 기반의 웹 애플리케이션

#### 컴파일 언어
Spring : JAVA 기반의 웹 애플리케이션 ( Spring Boot도 유명하다 )

### 데이터베이스

#### SQL(Structured Query Language)
관계형 데이터베이스 관리 시스템(RDBMS)의 데이터를 관리하기 위해 설계된 특수 목적의 프로그래밍 언어입니다.
> 규칙에맞는데이터입력<br>
> 테이블간JOIN지원<br>
> 트랜잭션 지원<br>
> 안정성, 일관성<br>
> 용어(테이블, 로우, 컬럼)<br>
> Scale-Up으로 DB를 증설 합니다.<br>

#### NoSQL(Not only SQL)
전통적인 관계형 데이터베이스 보다 덜 제한적인 일관성 모델을 이용하는 데이터의 저장 및 검색을 위한 매커니즘을 제공합니다.
> 자유로운데이터입력<br>
> 컬렉션간JOIN미지원<br>
> 트랜잭션 미지원<br>
> 확장성, 가용성<br>
> 용어(컬렉션, 다큐먼트, 필드)<br>
> Scale-out으로 DB를 증설 합니다. ( Scale-Up과 다르게 무제한적으로 늘려 갈 수 있습니다. )

### RESTAPI

#### 기본 설명
> URI는 정보의 자원을 표현해야 합니다.
> 자원의 행위는 HTTP Method로 표현해야 합니다.

|메소드|의미|Idempotent|
|----|---|-----------|
|POST|Create|No|
|GET|Select|Yes|
|PUT|Update|Yes|
|DELETE|Delete|Yes|

#### 특성
1. 유니폼 인터페이스(Uniform Interface)
1. 무상태성/스테이트리스(Stateless)
1. 캐슁 가능(Cacheable)
1. 자체 표현 구조(Self-descriptiveness)
1. 클라이언트 서버 구조 (Client-Server 구조)

##### REST 안티 패턴
> GET/POST를 이용한 터널링<br>
> Self-descriptiveness 속성을 사용하지 않음<br>
> HTTP Response code를 사용하지 않음<br>

#### 설계 가이드
REST URI는 심플하고 직관적으로 만들자
> URI에 리소스명은 동사보다는 명사를 사용 합니다.( 단수형 명사 보다는 복수형 명사 사용 )<br>
리소스간의 관계를 표현하는 방법
> Option 1. 서브 리소스로 표현하는 방법<br>
> Option 2. 서브 리소스에 관계를 명시 하는 방법<br>
에러처리
> 에러처리의 기본은 HTTP Response Code를 사용한 후, Response body에 error detail을 서술하는 것이 좋습니다.<br>
API 버전 관리
> API 정의에서 중요한 것중의 하나는 버전 관리입니다.<br>
페이징
> 큰 사이즈의 리스트 형태의 응답을 처리하기 위해서는 페이징 처리와 partial response 처리가 필요합니다.<br>
Partial Response 처리
> 리소스에 대한 응답 메세지에 대해서 굳이 모든 필드를 포함할 필요가 없는 케이스가 있습니다.<br>
검색 (전역검색과 지역검색)
> 검색은 일반적으로 HTTP GET에서 Query String에 검색 조건을 정의하는 경우가 일반적인데, 이 경우 검색조건이 다른 Query String과 섞여 버릴 수 있습니다.<br>
HATEOS를 이용한 링크 처리
> HATEOS는 Hypermedia as the engine of application state의 약어로, 하이퍼미디어의 특징을 이용하여 HTTP Response에 다음 Action이나 관계되는 리소스에 대한 HTTP Link를 함께 리턴하는 것입니다.<br>
단일 API 엔드포인트 활용

#### 문제점
1. JSON+HTTP 를 쓰면 REST인가?
1. 표준 규약이 없다
1. 기존의 전통적인 RDBMS에 적용 시키기에 쉽지 않다.

### API 문서화
클라이언트가 문서만 보고도 서버에 어떤 요청을 해야하고 응답을 얻을 수 있을지에 대해 작성해 줍니다.<br>
> GitHub Wiki에 Markdown을 사용하여 작성 할 수 있습니다.
> Swagger로 문서화와 데스트를 자동화를 할 수 있습니다.

#### Testing 도구
Postman<br>
Insomnia<br>
> 취향 차이이지만 Postman을 더 많이 쓰는거 같습니다.

### RDB
#### 정규화
중복 제거로 인한 무결성 증가 시킵니다.
#### 반정규화
조회 시 조인을 줄여 I/O 요청을 줄입니다. ( 성능 향상 )

### 배포
#### 클라우드 서버
#### AWS
#### Azure
#### GCP(Google Cloud Platform)
#### 홈서버

### CI / CD

#### 정의
CI (Continuous Integration)<br>
CD (Continuous Delivery or Continuos Deploy)<br>
빌드, 테스트, 배포 등을 자동으로 해주는 서비스<br>

#### 종류
Travis<br>
Jenkins<br>
등등...<br>
